<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To Do List</title>
    <link rel="stylesheet" href="style/master.css">
    <link rel="stylesheet" href="style/output.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Signika+Negative:wght@300..700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
</head>

<section id="favPage" class="w-full h-[100vh] flex justify-evenly items-center favFont absolute top-0 left-0 py-5">
    <!-- -------------------menu mobile version----------------------- -->
    <nav id="nav" class="md:hidden absolute z-10 top-0 -left-[400px] flex w-1/2 h-full flex-wrap justify-center items-center favColor1
        rounded-[10px]">
        <figure class="w-full h-fit absolute top-[30px] left-0">
            <img class="object-cover" src="assets/img/Project (20250911072123).png" alt="">
        </figure>
        <span id="closeBtn"
            class="material-symbols-outlined absolute top-5 right-5 text-[#8ab8a8] hover:scale-[1.5] cursor-pointer duration-500">close</span>
        <ul class="w-full h-fit flex flex-wrap justify-center items-center px-2.5">
            <li
                class="w-full h-fit flex justify-center items-center *:p-2.5 border-b border-b-[#8ab8a8] *:w-full *:h-full *:flex *:items-center *:hover:bg-[rgba(138,184,168,0.3)] *:duration-500 text-gray-700">
                <a href="index.html"><span class="material-symbols-outlined pr-2 text-[#8ab8a8]">today</span>Home</a>
            </li>
            <li
                class="w-full h-fit flex justify-center items-center *:p-2.5 border-b border-b-[#8ab8a8] *:w-full *:h-full *:flex *:items-center *:hover:bg-[rgba(138,184,168,0.3)] *:duration-500 text-gray-700">
                <a href="#"><span class="material-symbols-outlined pr-2 text-[#8ab8a8]">favorite</span>Favorites</a>
            </li>
            <li
                class="w-full h-fit flex justify-center items-center *:p-2.5 border-b border-b-[#8ab8a8] *:w-full *:h-full *:flex *:items-center *:hover:bg-[rgba(138,184,168,0.3)] *:duration-500 text-gray-700">
                <a href="index3.html"><span
                        class="material-symbols-outlined pr-2 text-[#8ab8a8]">date_range</span>Weekly Planner</a>
            </li>
            <li
                class="trash w-full h-fit flex justify-center items-center *:p-2.5 border-b border-b-[#8ab8a8] *:w-full *:h-full *:flex *:items-center *:hover:bg-[rgba(138,184,168,0.3)] *:duration-500 text-gray-700">
                <span class="cursor-pointer">
                    <span class="material-symbols-outlined pr-2 text-[#8ab8a8]">delete</span>Trash
                </span>
            </li>
            <li
                class="w-full h-fit flex justify-center items-center *:p-2.5 *:w-full *:h-full *:flex *:items-center *:hover:bg-[rgba(138,184,168,0.3)] *:duration-500 text-gray-700">
                <a href="index4.html"><span class="material-symbols-outlined pr-2 text-[#8ab8a8]">person</span></span>Contact</a>
            </li>
        </ul>
    </nav>
    <!-- ---------------menu in larger screen version----------------- -->
    <nav class="hidden md:flex w-[20%] h-full flex-wrap justify-center items-center favColor1 rounded-[10px] relative">
        <figure class="w-full h-fit absolute top-[30px] left-0">
            <img class="object-cover" src="assets/img/Project (20250911072123).png" alt="">
        </figure>
        <ul class="w-full h-fit flex flex-wrap justify-center items-center px-2.5">
            <li
                class="w-full h-fit flex justify-center items-center *:p-2.5 border-b border-b-[#8ab8a8] *:w-full *:h-full *:flex *:items-center *:hover:bg-[rgba(138,184,168,0.3)] *:duration-500 text-gray-700">
                <a href="index.html"><span class="material-symbols-outlined pr-2 text-[#8ab8a8]">home</span>Home</a>
            </li>
            <li
                class="w-full h-fit flex justify-center items-center *:p-2.5 border-b border-b-[#8ab8a8] *:w-full *:h-full *:flex *:items-center *:hover:bg-[rgba(138,184,168,0.3)] *:duration-500 text-gray-700">
                <a href="#"><span class="material-symbols-outlined pr-2 text-[#8ab8a8]">favorite</span>Favorites</a>
            </li>
            <li
                class="w-full h-fit flex justify-center items-center *:p-2.5 border-b border-b-[#8ab8a8] *:w-full *:h-full *:flex *:items-center *:hover:bg-[rgba(138,184,168,0.3)] *:duration-500 text-gray-700">
                <a href="index3.html"><span
                        class="material-symbols-outlined pr-2 text-[#8ab8a8]">date_range</span>Weekly Planner</a>
            </li>
            <li
                class="trash w-full h-fit flex justify-center items-center *:p-2.5 border-b border-b-[#8ab8a8] *:w-full *:h-full *:flex *:items-center *:hover:bg-[rgba(138,184,168,0.3)] *:duration-500 text-gray-700">
                <span class="cursor-pointer">
                    <span class="material-symbols-outlined pr-2 text-[#8ab8a8]">delete</span>Trash
                </span>
            </li>
            <li
                class="w-full h-fit flex justify-center items-center *:p-2.5 *:w-full *:h-full *:flex *:items-center *:hover:bg-[rgba(138,184,168,0.3)] *:duration-500 text-gray-700">
                <a href="index4.html"><span class="material-symbols-outlined pr-2 text-[#8ab8a8]">person</span></span>Contact</a>
            </li>
        </ul>
    </nav>
    <main
        class="w-[95%] md:w-[75%] h-full flex flex-wrap justify-center bg-orange-300 rounded-[10px] overflow-y-scroll relative">
        <div id="navBtn"
            class="size-[50px] rounded-[10px] favColor2 flex justify-center items-center absolute top-5 left-5 md:hidden cursor-pointer">
            <span class="material-symbols-outlined text-[#fdf5bf] hover:scale-[1.5] duration-500">menu</span>
        </div>
        <div
            class="w-full h-fit p-5 flex flex-wrap justify-center items-center my-[70px] border-b border-b-[#fdf5bf] gap-2.5 md:mt-0">
            <!-- ---------------------task bar--------------------------- -->
            <input type="text" name="" id="tsk" placeholder="Enter a Task ..."
                class="w-[70%] md:w-[40%] h-[50px] flex items-center p-2.5 bg-[#ffffff7e] placeholder:text-[#506b61] rounded-[10px]">
            <button id="addtsk"
                class="size-[50px] flex justify-center items-center favColor2 text-[#fdf5bf] rounded-[10px] *:hover:scale-[1.5] *:duration-300 cursor-pointer"><span
                    class="material-symbols-outlined">add</span></button>


            <!-- ---------------------search bar--------------------------- -->
            <input id="tskSearch" type="text" autocomplete="off" placeholder="Search ..."
                class="w-[70%] md:w-[40%] h-[50px] flex items-center p-2.5 bg-[#ffffff7e] placeholder:text-[#506b61] rounded-[10px]">
            <button id="searchBtn"
                class="size-[50px] flex justify-center items-center favColor2 text-[#fdf5bf] rounded-[10px] *:hover:scale-[1.5] *:duration-300 cursor-pointer"><span
                    class="material-symbols-outlined">search</span></button>

            <!-- ---------------------header--------------------------- -->
            <figure class="w-[100px] h-fit animate-bounce mt-5">
                <img class="object-cover" src="assets/img/Project (20250913014437).png" alt="">
            </figure>
            <figcaption class="w-full h-fit text-center text-[16px] text-green-900">Here you can add your favorite
                activities or hobbies. <br>Complete three main tasks and reward yourself with a bonus!</figcaption>
        </div>
        <!-- ---------------------task list--------------------------- -->
        <div id="tsklist" class="w-full min-h-[70%] max-h-[75%] overflow-y-auto p-5 flex flex-wrap justify-center">
            <ul
                class="w-[95%] h-fit flex flex-wrap justify-center *:p-2.5 gap-y-2 *:flex *:items-center *:w-full *:h-fit *:bg-[#ffffff3b] *:text-gray-700 *:rounded-[10px]">
            </ul>
        </div>
    </main>
    <!-- ------------------------Trash----------------------------- -->
    <div id="bin" class="w-full h-[100vh] myBg absolute top-0 left-0 flex justify-center items-center z-20">
        <aside class="w-[90%] md:w-[75%] h-[90vh] flex flex-wrap justify-center favColor2 rounded-[10px] relative">
            <span id="bincls"
                class="material-symbols-outlined absolute top-5 right-5 text-[#fdf5bf] hover:scale-[1.5] cursor-pointer duration-500">close</span>
            <div class=" mt-[50px] w-full min-h-[70%] max-h-[75%] overflow-y-auto p-5 flex flex-wrap justify-center">
                <ul
                    class="w-[95%] h-fit flex flex-wrap justify-center *:p-2.5 gap-y-2 *:flex *:items-center *:w-full *:h-fit *:bg-[#ffffff3b] *:text-gray-700 *:rounded-[10px]">
                </ul>
            </div>
        </aside>
    </div>
</section>
<script>
    // ---------------toggle menu-----------------
    let n = document.getElementById('navBtn')
    let _close = document.getElementById('closeBtn')
    let _nav = document.getElementById('nav')
    n.addEventListener('click', () => {
        _nav.style.left = '0px'
        _nav.style.transition = '1s'
    })
    _close.addEventListener('click', () => {
        _nav.style.left = '-400px'
        _close.style.transform = 'rotate(180deg)'
        _close.style.transition = '1s'
        _nav.style.transition = '1s'
    })
    // -------------------trash--------------------
    let t = document.querySelectorAll('.trash')
    let _binclose = document.getElementById('bincls')
    let _bin = document.getElementById('bin')
    _bin.style.display = 'none'
    t.forEach(item => {
        item.addEventListener('click', () => {
            _bin.style.display = 'flex'
        })
    })

    _binclose.addEventListener('click', () => {
        _bin.style.display = 'none'
        _binclose.style.transform = 'rotate(180deg)'
        _binclose.style.transition = '1s'
        _binclose.style.cursor = 'pointer'
    })

    // ------------------to do--------------------
    let _favdatabase = []
    let tskInp = document.getElementById('tsk')
    let tskBtn = document.getElementById('addtsk')
    let tsklist = document.querySelector('#tsklist>ul')
    let myfavStorage = JSON.parse(localStorage.getItem('favTask'))
    let _deletedTasks = []
    let deletedStorage = JSON.parse(localStorage.getItem('deletedTasks'))
    let Ctask = []
    let CtaskStorage = JSON.parse(localStorage.getItem('completedTasks'))

    if (CtaskStorage) {
        Ctask = [...CtaskStorage]
    }
    if (deletedStorage) {
        _deletedTasks = [...deletedStorage]
    }
    if (myfavStorage) {
        _favdatabase = [...myfavStorage]
    }
    _favdatabase.map((val) => {
        addtsk(val)
    })


    function addtsk(tsk) {
        let task = document.createElement('li')
        task.classList.add('task')
        task.innerHTML =
            ` <h5>${tsk}</h5>
            <input id="editInp" type="text">
            <button class"ebtn">Edit</button>
            <div>
            <span data-state='off' class="material-symbols-outlined checkmark">circle</span>
            <span class="material-symbols-outlined editBtn">edit_document</span>
            <span class="material-symbols-outlined delBtn">delete</span> 
            </div>
            `

        task.style.display = 'flex'
        task.style.alignItems = 'center'
        task.style.justifyContent = 'space-between'
        task.style.position = 'relative'
        task.querySelector('div').style.display = 'flex'
        task.querySelector('div').style.alignItems = 'center'
        task.querySelector('div').style.gap = '10px'
        task.querySelector('input').style.visibility = 'hidden'
        task.querySelector('input').style.width = '100%'
        task.querySelector('input').style.height = '100%'
        task.querySelector('input').style.borderRadius = '10px'
        task.querySelector('input').style.backgroundColor = '#fdf5bf'
        task.querySelector('input').style.position = 'absolute'
        task.querySelector('input').style.left = '0px'
        task.querySelector('input').style.display = 'flex'
        task.querySelector('input').style.alignItems = 'center'
        task.querySelector('input').style.padding = '10px'
        task.querySelector('button').style.position = 'absolute'
        task.querySelector('button').style.top = '50%'
        task.querySelector('button').style.right = '30px'
        task.querySelector('button').style.transform = 'translateY(-50%)'
        task.querySelector('button').style.backgroundColor = '#8ab8a8'
        task.querySelector('button').style.width = 'fit-content'
        task.querySelector('button').style.height = 'fit-content'
        task.querySelector('button').style.display = 'flex'
        task.querySelector('button').style.placeContent = 'center'
        task.querySelector('button').style.paddingInline = '10px'
        task.querySelector('button').style.borderRadius = '10px'
        task.querySelector('button').style.color = 'white'
        task.querySelector('button').style.cursor = 'pointer'
        task.querySelector('button').style.visibility = 'hidden'
        task.querySelectorAll('div > span').forEach(item => {
            item.style.color = '#fdf5bf'
        })
        task.querySelectorAll('div > span').forEach(item => {
            item.style.cursor = 'pointer'
        })

        // ------------------delete--------------------
        let delBtn = task.querySelector('.delBtn')
        let dellist = document.querySelector('#bin>aside>div>ul')

        if (_deletedTasks.includes(tsk)) {

            dellist.appendChild(task)
            delBtn.innerText = 'undo'
            delBtn.classList.remove('delBtn')
            delBtn.classList.add('restoreBtn')
            delBtn.previousElementSibling.previousElementSibling.style.display = 'none'
            delBtn.previousElementSibling.style.display = 'none'
        } else {
            tsklist.appendChild(task)
        }

        delBtn.addEventListener('click', () => {
            if (delBtn.classList.contains('delBtn')) {
                dellist.appendChild(task)
                delBtn.innerText = 'undo'
                delBtn.classList.remove('delBtn')
                delBtn.classList.add('restoreBtn')
                delBtn.previousElementSibling.previousElementSibling.style.display = 'none'
                delBtn.previousElementSibling.style.display = 'none'
                _deletedTasks.push(task.querySelector('h5').innerText)
                localStorage.setItem('deletedTasks', JSON.stringify(_deletedTasks))
            } else {
                tsklist.appendChild(task)
                delBtn.innerText = 'delete'
                delBtn.classList.remove('restoreBtn')
                delBtn.classList.add('delBtn')
                delBtn.previousElementSibling.previousElementSibling.style.display = 'flex'
                delBtn.previousElementSibling.style.display = 'flex'
                let restoredText = task.querySelector('h5').innerText
                _deletedTasks = _deletedTasks.filter(item => item !== restoredText)
                localStorage.setItem('deletedTasks', JSON.stringify(_deletedTasks))
            }
        })
        // ------------------edit-----------------------
        let editBtn = task.querySelector('.editBtn')
        let h5 = task.querySelector('h5')
        let input = task.querySelector('input')
        let innerBtn = task.querySelector('button')

        input.value = h5.innerText
        editBtn.addEventListener('click', () => {
            input.style.visibility = 'visible'
            innerBtn.style.visibility = 'visible'
            innerBtn.onclick = () => {
                h5.innerText = input.value
                input.style.visibility = 'hidden'
                innerBtn.style.visibility = 'hidden'
                // Update localStorage
                let index = _favdatabase.indexOf(tsk)
                if (index !== -1) {
                    _favdatabase[index] = input.value
                    localStorage.setItem('favTask', JSON.stringify(_favdatabase))
                }

            }
        })

        // ------------------check----------------------
        let c = task.querySelector('.checkmark')

        if (Ctask.includes(tsk)) {
            c.innerHTML = `<span class="material-symbols-outlined">check_circle</span>`
            c.style.color = 'rgb(4, 177, 85)'
            h5.innerHTML = `<del>${h5.innerText}</del>`
            c.dataset.state = 'on'
        }

        c.addEventListener('click', () => {
            if (c.dataset.state === 'off') {
                if (!Ctask.includes(task.querySelector('h5').innerText)) {
                    Ctask.push(task.querySelector('h5').innerText)
                }
                localStorage.setItem('completedTasks', JSON.stringify(Ctask))
                c.innerHTML = `<span class="material-symbols-outlined">check_circle</span>`
                c.style.color = 'rgb(4, 177, 85)'
                h5.innerHTML = `<del>${h5.innerText}</del>`
                c.dataset.state = 'on'
            } else {
                c.innerHTML = `<span class="material-symbols-outlined">circle</span>`
                c.style.color = 'rgb(253, 245, 191)'
                h5.innerHTML = h5.innerText
                c.dataset.state = 'off'
                Ctask = Ctask.filter(item => item !== task.querySelector('h5').innerText)
                localStorage.setItem('completedTasks', JSON.stringify(Ctask))
            }
            // ------------popup after 3 checks---------------
            let task3 = document.querySelectorAll('#tsklist>ul>li')
            let checknum = 0

            task3.forEach((item) => {
                let ch = item.querySelector('.checkmark')
                if (ch.dataset.state === 'on') {
                    checknum++
                }
            })

            let pop = document.getElementById('popup')
            if (checknum === 3) {
                setTimeout(() => {
                    pop.classList.remove('hidden')
                    pop.classList.add('flex')
                }, 1000)
            } else {
                pop.classList.add('hidden')
                pop.classList.remove('flex')
            }
            let popcls = document.getElementById('popClose')
            popcls.addEventListener('click', () => {
                pop.style.display = 'none'
            })
        })

    }

    tskBtn.addEventListener('click', () => {
        let tsk = tskInp.value
        if (tsk === "") {
            alert('please enter a task!')
        } else {
            addtsk(tsk)
            _favdatabase.push(tsk)
            localStorage.setItem('favTask', JSON.stringify(_favdatabase))
            tskInp.value = ""
            tskInp.focus()
        }
    })

    // ------------------search--------------------
    tskSearch.addEventListener('keyup', (e) => {
        let searchVal = e.target.value
        let tempH5 = document.querySelectorAll('.task>h5')
        tempH5.forEach((val) => {
            if (val.innerText.indexOf(searchVal) >= 0) {
                val.parentElement.style.display = 'flex'

            } else if (val.innerText === '') {
                val.parentElement.style.display = 'none'
            }
            else {
                val.parentElement.style.display = 'none'

            }
        })

    })


</script>

</html>